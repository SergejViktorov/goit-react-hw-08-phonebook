(this["webpackJsonpgoit-react-hw-08-phonebook"]=this["webpackJsonpgoit-react-hw-08-phonebook"]||[]).push([[4],{25:function(t,e,n){t.exports={link:"Navigation_link__o3dGy",activelink:"Navigation_activelink__hKf4C"}},26:function(t,e,n){t.exports={link:"AuthNav_link__32KhK",activelink:"AuthNav_activelink__1ktos"}},31:function(t,e,n){t.exports={img:"UserMenu_img__296gy",menu:"UserMenu_menu__h2cM7",text:"UserMenu_text__3UEoZ"}},38:function(t,e,n){"use strict";n.d(e,"a",(function(){return k})),n.d(e,"b",(function(){return y})),n.d(e,"c",(function(){return x})),n.d(e,"d",(function(){return T}));var c,r,a=n(9),o=n.n(a),u=n(17),i=n(14),s=n.n(i),l=n(2),b=Object(l.b)("contact/fetchPhoneBookRequest"),j=Object(l.b)("contact/fetchPhoneBookSuccess"),d=Object(l.b)("contact/fetchPhoneBookError"),f=Object(l.b)("contact/addContactsRequest"),h=Object(l.b)("contact/addContactsSuccess"),O=Object(l.b)("contact/addContactsError"),p=Object(l.b)("contact/deleteContactsRequest"),g=Object(l.b)("contact/deleteContactsSuccess "),v=Object(l.b)("contact/deleteContactsError"),x=Object(l.b)("contact/filter"),k={fetchContacts:function(){return function(){var t=Object(u.a)(o.a.mark((function t(e){var n,c;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e(b()),t.prev=1,t.next=4,s.a.get("/contacts");case 4:n=t.sent,c=n.data,e(j(c)),t.next=12;break;case 9:t.prev=9,t.t0=t.catch(1),e(d());case 12:case"end":return t.stop()}}),t,null,[[1,9]])})));return function(e){return t.apply(this,arguments)}}()},addContacts:function(t){return function(){var e=Object(u.a)(o.a.mark((function e(n){var c,r;return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n(f),e.prev=1,e.next=4,s.a.post("contacts",t);case 4:c=e.sent,r=c.data,n(h(r)),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(1),n(O());case 12:case"end":return e.stop()}}),e,null,[[1,9]])})));return function(t){return e.apply(this,arguments)}}()},deleteContacts:function(t){return function(){var e=Object(u.a)(o.a.mark((function e(n){return o.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(),e.prev=1,e.next=4,s.a.delete("contacts/".concat(t));case 4:n(g(t)),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(1),n(v(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}()}},m=n(28),C=function(t){return t.contacts},_=function(t){return t.contacts.filter},y={getFilter:_,getVisibleContacts:Object(m.a)([function(t){return C(t).items},_],(function(t,e){var n=e.toLowerCase();return t.filter((function(t){return t.name.toLowerCase().includes(n)}))})),getContacts:C},I=n(3),w=n(5),N=n(30),L=n(8),U=Object(l.d)([],(c={},Object(I.a)(c,j,(function(t,e){return e.payload})),Object(I.a)(c,h,(function(t,e){var n=e.payload;return[].concat(Object(N.a)(t),[Object(w.a)({},n)])})),Object(I.a)(c,g,(function(t,e){var n=e.payload;return t.filter((function(t){return t.id!==n}))})),c)),F=Object(l.d)(!1,(r={},Object(I.a)(r,b,(function(){return!0})),Object(I.a)(r,j,(function(){return!1})),Object(I.a)(r,d,(function(){return!1})),Object(I.a)(r,f,(function(){return!0})),Object(I.a)(r,h,(function(){return!1})),Object(I.a)(r,O,(function(){return!1})),Object(I.a)(r,p,(function(){return!0})),Object(I.a)(r,g,(function(){return!1})),Object(I.a)(r,v,(function(){return!1})),r)),S=Object(l.d)(null,{}),z=Object(l.d)("",Object(I.a)({},x,(function(t,e){return e.payload}))),T=Object(L.b)({items:U,isLoading:F,error:S,filter:z})},50:function(t,e,n){t.exports={container:"Container_container__2Z3gC"}},52:function(t,e,n){t.exports={heder:"AppBar_heder__2qIKS"}},7:function(t,e,n){"use strict";n.d(e,"b",(function(){return h})),n.d(e,"a",(function(){return f})),n.d(e,"c",(function(){return O}));var c=n(3),r=n(2),a=n(9),o=n.n(a),u=n(17),i=n(14),s=n.n(i),l=n(22);s.a.defaults.baseURL="https://connections-api.herokuapp.com";var b,j=function(t){s.a.defaults.headers.common.Authorization="Bearer ".concat(t)},d=function(){s.a.defaults.headers.common.Authorization=""},f={register:Object(r.c)("auth/register",function(){var t=Object(u.a)(o.a.mark((function t(e){var n,c,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/signup",e);case 3:return n=t.sent,c=n.data,j(c.token),t.abrupt("return",c);case 9:return t.prev=9,t.t0=t.catch(0),a=t.t0.data,l.b.error({data:a},{theme:"colored"}),t.abrupt("return",r.c.rejectWithValue());case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),logIn:Object(r.c)("auth/login",function(){var t=Object(u.a)(o.a.mark((function t(e){var n,c,a;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/login",e);case 3:return n=t.sent,c=n.data,j(c.token),t.abrupt("return",c);case 9:return t.prev=9,t.t0=t.catch(0),a=t.t0.data,l.b.error({data:a},{theme:"colored"}),t.abrupt("return",r.c.rejectWithValue());case 14:case"end":return t.stop()}}),t,null,[[0,9]])})));return function(e){return t.apply(this,arguments)}}()),logOut:Object(r.c)("auth/logout",Object(u.a)(o.a.mark((function t(){return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,s.a.post("/users/logout");case 3:d(),t.next=8;break;case 6:t.prev=6,t.t0=t.catch(0);case 8:case"end":return t.stop()}}),t,null,[[0,6]])})))),fetchCurrentUser:Object(r.c)("auth/refresh",function(){var t=Object(u.a)(o.a.mark((function t(e,n){var c,r,a,u;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(c=n.getState(),null!==(r=c.auth.token)){t.next=5;break}return console.log("\u0422\u043e\u043a\u0435\u043d\u0430 \u043d\u0435\u0442, \u0443\u0445\u043e\u0434\u0438\u043c \u0438\u0437 fetchCurrentUser"),t.abrupt("return",n.rejectWithValue());case 5:return j(r),t.prev=6,t.next=9,s.a.get("/users/current");case 9:return a=t.sent,u=a.data,t.abrupt("return",u);case 14:t.prev=14,t.t0=t.catch(6);case 16:case"end":return t.stop()}}),t,null,[[6,14]])})));return function(e,n){return t.apply(this,arguments)}}())},h=Object(r.e)({name:"auth",initialState:{user:{name:null,email:null},token:null,isLoggedIn:!1,isFetchingCurrent:!1},extraReducers:(b={},Object(c.a)(b,f.register.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(c.a)(b,f.logIn.fulfilled,(function(t,e){t.user=e.payload.user,t.token=e.payload.token,t.isLoggedIn=!0})),Object(c.a)(b,f.logOut.fulfilled,(function(t,e){t.user={name:null,email:null},t.token=null,t.isLoggedIn=!1})),Object(c.a)(b,f.fetchCurrentUser.pending,(function(t){t.isFetchingCurrent=!0})),Object(c.a)(b,f.fetchCurrentUser.fulfilled,(function(t,e){t.user=e.payload,t.isLoggedIn=!0,t.isFetchingCurrent=!1})),Object(c.a)(b,f.fetchCurrentUser.rejected,(function(t){t.isFetchingCurrent=!1})),b)}).reducer,O={getIsLoggedIn:function(t){return t.auth.isLoggedIn},getUserName:function(t){return t.auth.user.name},getIsFetchingCurrent:function(t){return t.auth.isFetchingCurrent}}},92:function(t,e,n){"use strict";n.r(e);var c=n(0),r=n.n(c),a=n(21),o=n.n(a),u=n(15),i=n(6),s=n(49),l=n(50),b=n.n(l),j=n(1);function d(t){var e=t.children;return Object(j.jsx)("div",{className:b.a.container,children:e})}var f=n(4),h=n(25),O=n.n(h),p=n(7);var g=function(){var t=Object(i.c)(p.c.getIsLoggedIn);return Object(j.jsxs)("nav",{children:[Object(j.jsx)(u.b,{to:"/",exact:!0,className:O.a.link,activeClassName:O.a.activelink,children:"\u0413\u043b\u0430\u0432\u043d\u0430\u044f"}),t&&Object(j.jsx)(u.b,{exact:!0,to:"/contacts",className:O.a.link,activeClassName:O.a.activelink,children:"\u041a\u043e\u043d\u0442\u0430\u043a\u0442\u044b"})]})},v=n.p+"static/media/ava.add6a313.svg",x=n(31),k=n.n(x),m=n(94);var C=function(){var t=Object(i.b)(),e=Object(i.c)(p.c.getUserName);return Object(j.jsxs)("div",{className:k.a.menu,children:[Object(j.jsx)("img",{src:v,alt:"avatar",className:k.a.img}),Object(j.jsxs)("span",{className:k.a.text,children:["\u0414\u043e\u0431\u0440\u043e \u043f\u043e\u0436\u0430\u043b\u043e\u0432\u0430\u0442\u044c ",e]}),Object(j.jsx)(m.a,{variant:"primary",type:"button",onClick:function(){return t(p.a.logOut())},children:"\u0412\u044b\u0445\u043e\u0434"})]})},_=n(52),y=n.n(_),I=n(26),w=n.n(I);var N=function(){return Object(j.jsxs)("div",{children:[Object(j.jsx)(u.b,{to:"/register",exact:!0,className:w.a.link,activeClassName:w.a.activelink,children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(j.jsx)(u.b,{to:"/login",exact:!0,className:w.a.link,activeClassName:w.a.activelink,children:"\u041b\u043e\u0433\u0438\u043d"})]})};var L=function(){var t=Object(i.c)(p.c.getIsLoggedIn);return console.log("isLoggedIn",t),Object(j.jsxs)("header",{className:y.a.heder,children:[Object(j.jsx)(g,{}),t?Object(j.jsx)(C,{}):Object(j.jsx)(N,{})]})},U=n(5),F=n(19),S=["redirectTo","children"];function z(t){var e=t.redirectTo,n=void 0===e?"/":e,c=t.children,r=Object(F.a)(t,S),a=Object(i.c)(p.c.getIsLoggedIn);return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},r),{},{children:a?c:Object(j.jsx)(f.a,{to:n})}))}var T=["children","restricted","redirectTo"];function A(t){var e=t.children,n=t.restricted,c=void 0!==n&&n,r=t.redirectTo,a=void 0===r?"/":r,o=Object(F.a)(t,T),u=Object(i.c)(p.c.getIsLoggedIn)&&c;return Object(j.jsx)(f.b,Object(U.a)(Object(U.a)({},o),{},{children:u?Object(j.jsx)(f.a,{to:a}):e}))}n(87);var B=n(22),E=(n(88),Object(c.lazy)((function(){return n.e(3).then(n.bind(null,105))}))),M=Object(c.lazy)((function(){return n.e(1).then(n.bind(null,106))})),R=Object(c.lazy)((function(){return n.e(2).then(n.bind(null,107))})),q=Object(c.lazy)((function(){return Promise.all([n.e(7),n.e(0)]).then(n.bind(null,109))}));var K=function(){var t=Object(i.b)(),e=Object(i.c)(p.c.getIsFetchingCurrent);return Object(c.useEffect)((function(){t(p.a.fetchCurrentUser())}),[t]),!e&&Object(j.jsxs)(d,{children:[Object(j.jsx)(L,{}),Object(j.jsx)(f.d,{children:Object(j.jsxs)(c.Suspense,{fallback:Object(j.jsx)("p",{children:"...\u0417\u0430\u0433\u0440\u0443\u0436\u0430\u0435\u043c"}),children:[Object(j.jsx)(A,{exact:!0,path:"/",children:Object(j.jsx)(M,{})}),Object(j.jsx)(A,{exact:!0,path:"/register",restricted:!0,children:Object(j.jsx)(E,{})}),Object(j.jsx)(A,{exact:!0,path:"/login",restricted:!0,redirectTo:"/contacts",children:Object(j.jsx)(R,{})}),Object(j.jsx)(z,{path:"/contacts",redirectTo:"/login",children:Object(j.jsx)(q,{})})]})}),Object(j.jsx)(B.a,{position:"top-right",autoClose:4e3,closeOnClick:!0})]})},P=n(30),V=n(2),W=n(18),J=n(53),Z=n.n(J),G=n(54),D=n.n(G),H=n(38),Q=[].concat(Object(P.a)(Object(V.f)({serializableCheck:{ignoredActions:[W.a,W.f,W.b,W.c,W.d,W.e]}})),[Z.a]),X={key:"auth",storage:D.a,whitelist:["token"]},Y=Object(V.a)({reducer:{auth:Object(W.g)(X,p.b),contacts:H.d},middleware:Q,devTools:!1}),$=Object(W.h)(Y);n(91);o.a.render(Object(j.jsx)(r.a.StrictMode,{children:Object(j.jsx)(i.a,{store:Y,children:Object(j.jsx)(s.a,{loading:null,persistor:$,children:Object(j.jsx)(u.a,{children:Object(j.jsx)(K,{})})})})}),document.getElementById("root"))}},[[92,5,6]]]);
//# sourceMappingURL=main.97f85907.chunk.js.map